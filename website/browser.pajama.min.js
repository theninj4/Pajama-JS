!function(e){var t=t||null;function r(e){for(var t in e){this[t]=e[t]}}function n(e,t,n,a){if(!e.hasOwnProperty(t)){e[t]=""}if(e[t]instanceof Function){var i=function(r){e[t].call(e,a.getAttr(n),r)};a.garbage.push(function(){a.removeEvent(n,i)});a.addEvent(n,i);return}if(!Object.getOwnPropertyDescriptor(e,t).hasOwnProperty("get")){var o=e[t];var f=[];var s;Object.defineProperty(e,t,{get:function(){return s.getAttr(n)},set:function(n){if(n instanceof r){s=n.element;var i=function(){n.element.setAttr(n.attr,o)};var l=function(r){if(n.element.getAttr(n.attr)!=o){e[t]=n.element.getAttr(n.attr)}};a.garbage.push(function(){s=null;var r=f.indexOf(i);if(r>=0){f.splice(r,1)}n.element.removeEvent("change",l);n.element.removeEvent("keyup",l);Object.defineProperty(e,t,{value:o,writable:true})});f.push(i);n.element.addEvent("change",l);n.element.addEvent("keyup",l);n.element.setAttr(n.attr,o)}else{o=n;for(var u=0;u<f.length;u++){f[u].call(a,o)}}},enumerable:true})}e[t]=new r({element:a,attr:n})}function a(e,t,n,a){if(!e.hasOwnProperty(t)){e[t]=[]}if(!Object.getOwnPropertyDescriptor(e,t).hasOwnProperty("get")){var i=e[t];var o=[];Object.defineProperty(e,t,{get:function(){var r=i.concat([]);Object.defineProperty(r,"pop",{value:function(){var e=i.pop();for(var t=0;t<o.length;t++){var r=o[t].element.getNodes();r[r.length-1].remove()}return e}});Object.defineProperty(r,"push",{value:function(){var e=i.push.apply(i,Array.prototype.slice.call(arguments));for(var t=0;t<o.length;t++){var r=o[t];r.element.append(r.func.call({},arguments[0]))}return e}});Object.defineProperty(r,"reverse",{value:function(){var r=i.reverse();e[t]=i;return r}});Object.defineProperty(r,"shift",{value:function(){var e=i.shift();for(var t=0;t<o.length;t++){var r=o[t].element.getNodes();r[0].remove()}return e}});Object.defineProperty(r,"sort",{value:function(){var r=i.sort.apply(i,Array.prototype.slice.call(arguments));e[t]=i;return r}});Object.defineProperty(r,"splice",{value:function(){var r=i.splice.apply(i,Array.prototype.slice.call(arguments));e[t]=i;return r}});Object.defineProperty(r,"unshift",{value:function(){var e=i.unshift.apply(i,Array.prototype.slice.call(arguments));for(var t=0;t<o.length;t++){var r=o[t];r.element.prepend(r.func.call({},arguments[0]))}return e}});return r},set:function(n){if(n instanceof r){o.push({element:n.element,func:n.func})}else{i=n}for(var a=0;a<o.length;a++){var f=o[a];f.element.clear();for(var s in i){f.element.append(f.func.call({},e[t][s]))}}},enumerable:true})}e[t]=new r({element:n,func:a})}var i=0;function o(e){if(!e)e={};if(!e.tag)e.tag="div";var r=document.createElement(e.tag);var f=this;f.dom=r;f.eventList=[];f.garbage=[];r._view=f;f.uuid=i++;f.prepend=function(e){var r=e;if(!(r instanceof Array))r=Array.prototype.slice.call(arguments);for(var n=0;n<r.length;n++){var a=r[n];if(a instanceof o){f.dom.insertBefore(a.dom,f.dom.firstChild);if(t)f.fireEvent("PjsChange",{type:"prepend",parent:f.uuid,markup:a.toMarkup(true)})}else{f.prepend(new o(a))}}};f.append=function(e){var r=e;if(!(r instanceof Array))r=Array.prototype.slice.call(arguments);for(var n=0;n<r.length;n++){var a=r[n];if(a instanceof o){f.dom.appendChild(a.dom);if(t)f.fireEvent("PjsChange",{type:"append",parent:f.uuid,markup:a.toMarkup(true)})}else{f.append(new o(a))}}};f.remove=function(e){if(t&&!e){f.fireEvent("PjsChange",{type:"remove",parent:f.dom.parentNode._view.uuid,child:f.uuid})}f.dom.parentNode.removeChild(f.dom);f.recycle()};f.recycle=function(){var e=f.getNodes();for(var t=0;t<e.length;t++){e[t].recycle()}for(var t=0;t<f.garbage.length;t++){f.garbage[t]()}};f.addClass=function(e){if(e!=""){f.dom.className=f.dom.className||"";f.dom.className+=" "+e}};f.removeClass=function(e){if(e!=""){f.dom.className=(" "+f.dom.className+" ").replace(" "+e+" ","")}};f.hasClass=function(e){return(" "+f.dom.className+" ").indexOf(" "+e+" ")!=-1};f.setAttr=function(e,r){if(typeof e=="string"&&f.dom[e]!=r){f.dom[e]=r;f.dom.setAttribute(e,r);if(t)f.fireEvent("PjsChange",{type:"attr",id:f.uuid,attr:e,value:r})}};f.getAttr=function(e){return f.dom[e]};f.addEvent=function(e,t){f.dom.addEventListener(e,t);if(f.eventList.indexOf(e)==-1)f.eventList.push(e)};f.removeEvent=function(e,t){f.dom.removeEventListener(e,t)};f.setValue=function(e){if(["input","select"].indexOf(f.dom.tagName.toLowerCase())!=-1){f.dom.value=e}else{f.dom.innerHTML=e}};f.getValue=function(){return f.dom.value||f.dom.innerHTML};f.clear=function(){var e=f.dom.childNodes.length;for(var r=0;r<e;r++){f.dom.childNodes[0]._view.remove(true)}if(t)f.fireEvent("PjsChange",{type:"clear",parent:f.uuid});return f};f.fireEvent=function(e,t){var r=document.createEvent("HTMLEvents");r.initEvent(e,true,true);r.detail=t;f.dom.dispatchEvent(r);return f};f.getNodes=function(){var e=[];for(var t=0;t<f.dom.childNodes.length;t++){var r=f.dom.childNodes[t];if(r._view){e.push(r._view)}else{var n=new o;n.dom=r;e.push(n)}}return e};f.getByUuid=function(e){if(f.uuid==e)return f;for(var t=0;t<f.dom.childNodes.length;t++){var r=f.dom.childNodes[t]._view.getByUuid(e);if(r)return r}return null};f.toMarkup=function(e){var t="<"+f.dom.tagName;for(var r in f.dom){if(["tagName","elemCount","classList","addEventListener","appendChild","removeChild","childNodes","dispatchEvent","_view","parentNode"].indexOf(r)<0){if(typeof f.dom[r]=="string"||typeof f.dom[r]=="number"){t+=" "+r+'="'+f.dom[r]+'"'}}}if(e){t+=" id='"+f.uuid+"'";for(var n in f.eventList){var a=f.eventList[n];t+=" on"+a+"=\"dispatch('"+f.uuid+"', '"+a+"', event)\" "}}t+=">";if(f.dom.innerHTML){t+=f.dom.innerHTML}for(var i in f.dom.childNodes){t+=f.dom.childNodes[i]._view.toMarkup(e)}return t+"</"+f.dom.tagName+">"};if(e.classes){for(var s=0;s<e.classes.length;s++){f.addClass(e.classes[s])}}if(e.contains){var l=e.contains;if(l instanceof Object&&Object.keys(l).length==1&&e.forEach){var u=Object.keys(l)[0];a(l[u],u,f,e.forEach)}else{if(!(l instanceof Array))l=[l];for(var s=0;s<l.length;s++){f.append(l[s])}}}for(var s in e){if(s!="classes"&&s!="contains"&&s!="tag"&&s!="forEach"){var c=e[s];if(c instanceof Object){var d=Object.keys(c);for(var v=0;v<d.length;v++){var p=d[v];n(c[p],p,s,f)}}else{f.setAttr(s,e[s])}}}}var f={};var s=["model","view"];for(var l=0;l<s.length;l++){!function(e){f[e]={__pjsDefine:function(t,r){if(f[e].hasOwnProperty(t)){console.log("Duplicate definition found for "+e,t);return}f[e][t]=r},__pjsCreate:function(t,r){if(!f[e].hasOwnProperty(t)){console.error("Dynamic script loader failed to find "+e+":",t);return null}var r=Array.prototype.slice.call(arguments);r.shift();var n={};if(e=="view")n=new o({classes:["view."+t]});f[e][t].apply(n,r);return n}}}(s[l])}e.pjs={defineModel:f.model.__pjsDefine,defineView:f.view.__pjsDefine,element:o,model:f.model.__pjsCreate,view:f.view.__pjsCreate}}(window);